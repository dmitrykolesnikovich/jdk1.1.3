/*
 * @(#)Utility.java	1.3 97/01/27
 *
 * (C) Copyright Taligent, Inc. 1996, 1997 - All Rights Reserved
 * (C) Copyright IBM Corp. 1996, 1997 - All Rights Reserved
 *
 * Portions copyright (c) 1996 Sun Microsystems, Inc. All Rights Reserved.
 *
 *   The original version of this source code and documentation is copyrighted
 * and owned by Taligent, Inc., a wholly-owned subsidiary of IBM. These
 * materials are provided under terms of a License Agreement between Taligent
 * and Sun. This technology is protected by multiple US and International
 * patents. This notice and attribution to Taligent may not be removed.
 *   Taligent is a registered trademark of Taligent, Inc.
 *
 * Permission to use, copy, modify, and distribute this software
 * and its documentation for NON-COMMERCIAL purposes and without
 * fee is hereby granted provided that this copyright notice
 * appears in all copies. Please refer to the file "copyright.html"
 * for further important copyright and licensing information.
 *
 * SUN MAKES NO REPRESENTATIONS OR WARRANTIES ABOUT THE SUITABILITY OF
 * THE SOFTWARE, EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED
 * TO THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A
 * PARTICULAR PURPOSE, OR NON-INFRINGEMENT. SUN SHALL NOT BE LIABLE FOR
 * ANY DAMAGES SUFFERED BY LICENSEE AS A RESULT OF USING, MODIFYING OR
 * DISTRIBUTING THIS SOFTWARE OR ITS DERIVATIVES.
 *
 */
package java.text;

final class Utility {

  /**
   * Convenience utility to compare two Object[]s.
   * Ought to be in System
   */
  final static boolean arrayEquals(Object[] source, Object target) {
    if (source == null) return (target == null);
    if (!(target instanceof Object[])) return false;
    Object[] targ = (Object[]) target;
    return (source.length == targ.length
        && arrayRegionMatches(source, 0, targ, 0, source.length));
  }

  /**
   * Convenience utility to compare two int[]s
   * Ought to be in System
   */
  final static boolean arrayEquals(int[] source, Object target) {
    if (source == null) return (target == null);
    if (!(target instanceof int[])) return false;
    int[] targ = (int[]) target;
    return (source.length == targ.length
        && arrayRegionMatches(source, 0, targ, 0, source.length));
  }

  /**
   * Convenience utility to compare two double[]s
   * Ought to be in System
   */
  final static boolean arrayEquals(double[] source, Object target) {
    if (source == null) return (target == null);
    if (!(target instanceof double[])) return false;
    double[] targ = (double[]) target;
    return (source.length == targ.length
        && arrayRegionMatches(source, 0, targ, 0, source.length));
  }

  /**
   * Convenience utility to compare two Object[]s
   * Ought to be in System
   */
  final static boolean arrayEquals(Object source, Object target) {
    if (source == null) return (target == null);
    // for some reason, the correct arrayEquals is not being called
    // so do it by hand for now.
    if (source instanceof Object[])
      return(arrayEquals((Object[]) source,target));
    if (source instanceof int[])
      return(arrayEquals((int[]) source,target));
    if (source instanceof double[])
      return(arrayEquals((int[]) source,target));
    return source.equals(target);
  }

  /**
   * Convenience utility to compare two Object[]s
   * Ought to be in System.
   * @param len the length to compare.
   * The start indices and start+len must be valid.
   */
  final static boolean arrayRegionMatches(Object[] source, int sourceStart,
                                          Object[] target, int targetStart,
                                          int len)
  {
    int sourceEnd = sourceStart + len;
    int delta = targetStart - sourceStart;
    for (int i = sourceStart; i < sourceEnd; i++) {
      if (!arrayEquals(source[i],target[i + delta]))
        return false;
    }
    return true;
  }

  /**
   * Convenience utility to compare two int[]s.
   * @param len the length to compare.
   * The start indices and start+len must be valid.
   * Ought to be in System
   */
  final static boolean arrayRegionMatches(int[] source, int sourceStart,
                                          int[] target, int targetStart,
                                          int len)
  {
    int sourceEnd = sourceStart + len;
    int delta = targetStart - sourceStart;
    for (int i = sourceStart; i < sourceEnd; i++) {
      if (source[i] != target[i + delta])
        return false;
    }
    return true;
  }

  /**
   * Convenience utility to compare two arrays of doubles.
   * @param len the length to compare.
   * The start indices and start+len must be valid.
   * Ought to be in System
   */
  final static boolean arrayRegionMatches(double[] source, int sourceStart,
                                          double[] target, int targetStart,
                                          int len)
  {
    int sourceEnd = sourceStart + len;
    int delta = targetStart - sourceStart;
    for (int i = sourceStart; i < sourceEnd; i++) {
      if (source[i] != target[i + delta])
        return false;
    }
    return true;
  }

  /**
   * Convenience utility. Does null checks on objects, then calls equals.
   */
  final static boolean objectEquals(Object source, Object target) {
    if (source == null)
      return (target == null);
    else
      return arrayEquals(source,target);
  }
}

